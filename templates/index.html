<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iObject</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
        .prompt {
            cursor: pointer;
            display: inline-block;
            margin: 5px;
            padding: 5px;
            border: 1px solid #007bff;
            border-radius: 5px;
            background-color: #f8f9fa;
            color: #007bff;
        }

        .prompt:hover {
            background-color: #007bff;
            color: #ffffff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mt-4">iObject</h1>
        <div id="chat-container" class="card mt-4">
            <div id="chat-output" class="card-body" style="height: 400px; overflow-y: scroll;"></div>
            <div class="card-footer">
                <div class="input-group">
                    <input type="text" id="chat-input" class="form-control" placeholder="Please enter your sales objection: ">
                    <div class="input-group-append">
                        <button id="chat-submit" class="btn btn-primary">Send</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="prompt-container" class="mt-4">
            <h5>Sales Objection Examples:</h5>
            <div id="prompts"></div>
        </div>
    </div>

    <script>
        const examplePrompts = [
            "Can you just send me the information in an email?",
            "Is this a sales call?",
            "This isn’t a good time",
            "I’m the wrong person to talk to about this",
            "I need to get more quotes first",
            "I don’t want to sign a long contract",
            "We’re using your competitor",
            "Your competitor is cheaper",
            "I don’t see any ROI potential",
            "I’m not interested",
            "I’m busy",
            "How did you get my information?",
            "I’ve never heard of your company",
            "This looks too complicated for my team to learn",
            "We’re using this budget elsewhere",
            "Can you call me back next quarter?",
            "This is too expensive",
            "We’re happy with the way things are",
            "We don’t have a big enough team for this",
            "I saw a bad review of your company",
            "There's no money",
            "We don't have any budget left this year",
            "I don't want to get stuck in a contract",
            "I can get a cheaper version of your product somewhere else",
            "I'm not authorized to sign off on this purchase",
            "I can't sell this internally",
            "My boss isn't convinced",
            "We're being downsized / bought out",
        ];

        function displayExamplePrompts() {
            const container = document.getElementById("prompts");
            examplePrompts.forEach(prompt => {
                const div = document.createElement("div");
                div.classList.add("prompt");
                div.textContent = prompt;
                div.onclick = () => {
                    document.getElementById("chat-input").value = prompt;
                };
                container.appendChild(div);
            });
        }

        displayExamplePrompts();
    </script>

<script>
async function sendChatMessage(message) {
    const response = await fetch('/chatbot', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({ user_input: message })
    });

    return await response.json();
}

document.getElementById("chat-submit").addEventListener("click", async () => {
    const chatInput = document.getElementById("chat-input");
    const message = chatInput.value;

    if (message) {
        const chatOutput = document.getElementById("chat-output");
        const response = await sendChatMessage(message);

        const userMessage = document.createElement("div");
        userMessage.innerHTML = `<strong>Salesperson:</strong> ${message}`;
        chatOutput.appendChild(userMessage);

        const chatbotMessage = document.createElement("div");
        chatbotMessage.innerHTML = `<strong>iObject:</strong> ${response}`;
        chatOutput.appendChild(chatbotMessage);

        chatOutput.scrollTop = chatOutput.scrollHeight;

        chatInput.value = "";
    }
});
</script>

</body>
</html>